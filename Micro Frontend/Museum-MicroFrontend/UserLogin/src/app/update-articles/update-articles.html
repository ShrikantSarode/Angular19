<h1 class="text-center mt-5 mb-4">Update Article</h1>

<div class="update-article">
  
  <!-- Success Message -->
  <div *ngIf="updateArticleMessage && updateArticleMessage.includes('success')" class="alert alert-success">
    {{ updateArticleMessage }}
    <button type="button" class="btn-close" (click)="clearMessages()"></button>
  </div>

  <!-- General Error -->
  <div *ngIf="updateArticleMessage && !updateArticleMessage.includes('success')" class="alert alert-danger">
    {{ updateArticleMessage }}
    <button type="button" class="btn-close" (click)="clearMessages()"></button>
  </div>

  <!-- Field Errors Summary -->
  <div *ngIf="hasFieldErrors()" class="alert alert-warning">
    <strong>Please fix these errors:</strong>
    <ul>
      <li *ngFor="let field of Object.keys(fieldErrors)">
        {{ field }}: {{ fieldErrors[field] }}
      </li>
    </ul>
  </div>

  <form #updateArticle="ngForm" (ngSubmit)="update(updateArticle.value)" novalidate>
    
    <input type="hidden" name="articleId" [value]="selectedArticle.articleId" ngModel />

    <!-- Row 1: Art Name & Price -->
    <div class="row">
      <div class="col-6">
        <label for="artName">Art Name</label>
        <input
          class="form-input"
          [class.error-field]="hasError('artName')"
          type="text"
          name="artName"
          id="artName"
          placeholder="Enter Article Name"
          [(ngModel)]="selectedArticle.artName"
          required
        />
        <div *ngIf="hasError('artName')" class="error-text">
          {{ getError('artName') }}
        </div>
      </div>
      <div class="col-6">
        <label for="price">Price</label>
        <input
          class="form-input"
          [class.error-field]="hasError('price')"
          type="number"
          name="price"
          id="price"
          placeholder="Enter Article Price"
          [(ngModel)]="selectedArticle.price"
          required
          min="0"
          step="0.01"
        />
        <div *ngIf="hasError('price')" class="error-text">
          {{ getError('price') }}
        </div>
      </div>
    </div>

    <!-- Row 2: Description & Museum ID -->
    <div class="row mt-3">
      <div class="col-6">
        <label for="description">Description</label>
        <textarea
          class="form-input"
          [class.error-field]="hasError('description')"
          name="description"
          id="description"
          placeholder="Enter Article Description"
          [(ngModel)]="selectedArticle.description"
          rows="3"
        ></textarea>
        <div *ngIf="hasError('description')" class="error-text">
          {{ getError('description') }}
        </div>
      </div>
      <div class="col-6">
        <label for="museumId">Museum ID</label>
        <input
          class="form-input"
          [class.error-field]="hasError('museumId')"
          type="number"
          name="museumId"
          id="museumId"
          placeholder="Enter Museum ID"
          [(ngModel)]="selectedArticle.museumId"
          required
          min="1"
          step="1"
        />
        <div *ngIf="hasError('museumId')" class="error-text">
          {{ getError('museumId') }}
        </div>
      </div>
    </div>

     
    <div class="row mt-3">
      <div class="col-6">
        <label for="quantity">Quantity</label>
        <input
          class="form-input"
          [class.error-field]="hasError('quantity')"
          type="number"
          name="quantity"
          id="quantity"
          placeholder="Enter Article Quantity"
          [(ngModel)]="selectedArticle.quantity"
          required
          min="0"
          step="1"
        />
        <div *ngIf="hasError('quantity')" class="error-text">
          {{ getError('quantity') }}
        </div>
      </div>
      <div class="col-6">
        <label for="image">Image URL</label>
        <input
          class="form-input"
          [class.error-field]="hasError('image')"
          type="url"
          name="image"
          id="image"
          placeholder="Enter Article Image URL"
          [(ngModel)]="selectedArticle.image"
          required
        />
        <div *ngIf="hasError('image')" class="error-text">
          {{ getError('image') }}
        </div>
      </div>
    </div>

 
    <div class="row mt-3">
      <div class="col-6">
        <label for="remainingStock">Remaining Stock</label>
        <input
          class="form-input"
          [class.error-field]="hasError('remainingStock')"
          type="number"
          name="remainingStock"
          id="remainingStock"
          placeholder="Enter Remaining Stock"
          [(ngModel)]="selectedArticle.remainingStock"
          min="0"
          step="1"
          required
        />
        <div *ngIf="hasError('remainingStock')" class="error-text">
          {{ getError('remainingStock') }}
        </div>
      </div>
      <div class="col-6 text-center">
        <label>Image Preview</label>
        <div class="mt-2">
          <img
            *ngIf="selectedArticle.image"
            [src]="selectedArticle.image"
            alt="Article image preview"
            class="img-thumbnail mt-2"
            style="max-height: 150px; max-width: 100%"
          />
          <div *ngIf="!selectedArticle.image" class="text-muted">
            <i class="fas fa-image fa-2x"></i>
            <p class="small">No image preview</p>
          </div>
        </div>
      </div>
    </div>

     
    <div class="row mt-4">
      <div class="col-12 text-center">
        <button class="form-button btn btn-primary" [disabled]="updateArticle.invalid">
          Update Article
        </button>
        
        <button type="button" class="btn btn-secondary ms-3 mt-3" (click)="goBack()">
          Cancel
        </button>
      </div>
    </div>

  </form>
</div>
